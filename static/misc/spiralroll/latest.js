var LeChuckAPIjs=document.getElementById("LeChuckAPIjs");var LeChuckAPIjsBasedir="";var LeChuckAPIEasyXDMJSUrl;var LeChuckAPIEasyXDMLoaded=false;var LeChuckAPIEasyXDMOnLoaded=function(){};if(!LeChuckAPIjs){var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){if(scripts[i].getAttribute("src")&&scripts[i].getAttribute("src").match(/lechuck\/js\/[a-zA-Z0-9_]+\.js/i)){LeChuckAPIjs=scripts[i];break}}}if(!LeChuckAPIjs){if(typeof console=="object"&&"error" in console){console.error("Unable to find the LeChuckAPI object, make sure that the script has the id='LeChuckAPIjs' property set")}}else{if(document.location.href.match(/^file/)){if(typeof console=="object"&&"error" in console){console.error("LeChuck API doesn't support the file protocol. Methods that need CrossDomain communications will be disabled (and thats a lot of methods!).")}}LeChuckAPIjsBasedir=LeChuckAPIjs.getAttribute("src").replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")+"/"||null;if(!window.JSON||typeof(window.JSON)!="object"){document.write("<script type='text/javascript' src='"+LeChuckAPIjsBasedir+"easyxdm/json2.js'><\/script>")}if(LeChuckAPIjsBasedir.match(/mp_debug/)||document.location.href.match(/mp_debug/)||document.location.href.match(/xdm_debug/)){LeChuckAPIEasyXDMJSUrl=LeChuckAPIjsBasedir+"easyxdm/easyXDM.debug.js"}else{LeChuckAPIEasyXDMJSUrl=LeChuckAPIjsBasedir+"easyxdm/easyXDM.min.js"}document.write("<script type='text/javascript' src='"+LeChuckAPIEasyXDMJSUrl+"' id='LeChuckAPIEasyXDM'><\/script>");if(document.getElementById("LeChuckAPIEasyXDM")){LeChuckAPIEasyXDMLoaded=true}else{if(typeof console=="object"&&"warn" in console){console.warn("Unable to load EasyXDM "+LeChuckAPIEasyXDMJSUrl+" synchronously, trying to load it asynchronously.")}var script=document.createElement("script");script.src=LeChuckAPIEasyXDMJSUrl;script.id="LeChuckAPIEasyXDM";script.type="text/javascript";script.onload=function(a){LeChuckAPIEasyXDMLoaded=true;LeChuckAPIEasyXDMOnLoaded()};document.body.appendChild(script)
}}function LeChuckAPI(a){var b=this;var c;this._version="0.1.1";this._ready=false;this._buyItemsCallback=false;this._xdmGetCallbacks={};this._flash_object="MPFlashGame";this._trustedDomainsBackend=[/^api\.minijuegos\.com$/,/^ssl\.minijuegos\.com$/,/^api\.beta\.miniplay\.com$/,/\.miniplay\.com$/,/\.minijuegos\.com$/,/\.lab\.minijuegos\.com$/,/^lab\.minijuegos\.com$/];this._trustedDomainsSite=[/^www\.minijuegos\.com$/,/^www\.minigiochi\.com$/,/^www\.minijogos\.com\.br$/,/^www\.miniplay\.com$/,/beta\.miniplay\.com$/,/\.minijuegos\.com$/,/\.minijuegos\.mx$/,/\.minispelletjes\.com$/,/\.grymini\.pl$/];this.enableDebug=false;this.clientPayload="";this.id=0;this.anonymousMode=true;this.site="http://www.minijuegos.com/";this.site_https="https://ssl.minijuegos.com/";this.url="https://api.minijuegos.com/lechuck/client-js/";this.locale="en_US";this.locale_lang="en";this.integration_type=null;this.is_internal=false;this.is_external=false;this.is_mobile=false;this.is_embed=false;this.is_unity=false;this.user_id=null;this.user_token=false;this.user_uid=null;this.user_progress_level=false;this.user_avatar=false;this.user_avatar_mini=false;this.user_avatar_big=false;this.user_avatar_alpha=false;this.user_avatar_body=false;this.user_profile=false;this._player={is_scalable:null,is_resizable:null,view_type:null,current_view_type:null,is_maximized:null,size:{width:null,height:null},current_size:{width:null,height:null}};this.eventHandler=new function(){var d={apiReady:null,documentReady:null,userDisconnect:null,playerResize:null};this.init=function(){var f=document.addEventListener||document.attachEvent,e=document.addEventListener?"DOMContentLoaded":"onreadystatechange";window.LechuckOnDocumentReady=function(){b.eventHandler.triggerEvent("documentReady")};f.call(document,e,window.LechuckOnDocumentReady,false)};this.registerEventListener=function(e,f){if(typeof f=="function"&&e!=null){if(d[e]==null){d[e]=new Array()}d[e].push(f);return true}else{return false}};this.triggerEvent=function(f,g){b.debug("Event "+f+" triggered");
if(typeof g==undefined){g=null}if(d[f] instanceof Array){for(var e=0;e<d[f].length;e++){if(d[f][e](g)==false){return false}}}return true}};this.getVersion=function(){return b._version};this.get=function(d){if(self[d]!="undefined"){return self[d]}};this.getGameUid=function(){var d=document.location.href.match(/mp_game_uid=([^\&]*)/);if(d!=null&&d.length>=2){return unescape(d[1])}return null};this.getBaseUrl=function(){if(LeChuckAPIjs){var d=LeChuckAPIjs.src;return d.replace(/[^\/]+$/,"")}return null};this.getScript=function(f,g,e){var d=document.createElement("script");d.src=f;d.type="text/javascript";d.onload=function(){if(g!==undefined){g(f)}};d.onerror=function(){if(e!==undefined){e(f)}};document.body.appendChild(d)};this.getFlashObject=function(){if(typeof b._flash_object=="string"){b.setFlashObject(b._flash_object)}return b._flash_object};this.setFlashObject=function(e){var d;if(typeof e=="undefined"||e==null){return}if(typeof e=="string"){d=document.getElementById(e);if(d!=null){b._flash_object=d}}else{if(typeof e=="function"||typeof e=="object"){b._flash_object=e}else{throw new Error("FlashObject not valid")}}};this.debug=function(d){if(!b.enableDebug){return false}if(typeof console!="object"){return false}if(typeof d=="string"){this._showDebug("[js@LeChuck ~]$ "+d)}else{if(typeof d=="boolean"){this._showDebug(d?"true":"false")}else{this._showDebug(d)}}};this._showDebug=function(d){if(this.is_internal&&b.xdm.isConnected()){console.log(d)}else{console.log(d)}};this.log=function(d){if(typeof console!="object"){return false}if(typeof d=="string"){this._showLog("[js@LeChuck ~]$ "+d)}else{if(typeof d=="boolean"){this._showLog(d?"true":"false")}else{this._showLog(d)}}};this._showLog=function(d){if(this.is_internal&&b.xdm.isConnected()){console.log(d)}else{console.log(d)}};this.warn=function(d){if(typeof console!="object"){return false}if(typeof d=="string"){this._showWarn("[js@LeChuck ~]$ "+d)}else{if(typeof d=="boolean"){this._showWarn(d?"true":"false")}else{this._showWarn(d)
}}};this._showWarn=function(d){if(this.is_internal&&b.xdm.isConnected()){console.warn(d)}else{console.warn(d)}};this.error=function(d){if(!b.enableDebug){return false}if(typeof console!="object"){return false}if(typeof d=="string"){this._showError("[js@LeChuck ~]$ "+d)}else{if(typeof d=="boolean"){this._showError(d?"true":"false")}else{this._showError(d)}}};this._showError=function(d){if(this.is_internal&&b.xdm.isConnected()){console.error(d)}else{console.error(d)}};this.noIdError=function(){throw Error("Miniplay API: Sorry, you must specify an api ID in order to use it.")};this.newXhr=function(f,d){var h=false;if(d&&typeof d==="string"&&d.indexOf("#")===-1){d+=(d.indexOf("?")===-1?"?":"&")+"rnd="+Math.random()}try{h=new XMLHttpRequest()}catch(g){}if(h&&"withCredentials" in h){h.open(f,d,true)}else{if(typeof XDomainRequest!="undefined"){h=new XDomainRequest();h.open(f,d);h.onload=function(){this.readyState=4;if(this.onreadystatechange instanceof Function){this.onreadystatechange()}}}else{if(h){h.open(f,d,true)}}}return h};this.extendOptions=function(f,g){var d={};if(typeof f=="object"){for(var e in f){d[e]=f[e]}}if(typeof g=="object"){for(var e in g){d[e]=g[e]}}return d};this.removeURLParam=function(d,j){var h,g;var f=d.split("?");if(f.length>=2){h=encodeURIComponent(j)+"=";g=f[1].split(/[&;]/g);for(var e=g.length;e-->0;){if(g[e].indexOf(h,0)==0){g.splice(e,1)}}if(g.length>0){return f[0]+"?"+g.join("&")}else{return f[0]}}else{return d}};this.isPopupBlocked=function(e){var d=false;try{if(typeof e=="undefined"){d=true}else{if(e&&e.closed){d=false}else{if(e){d=false}else{d=true}}}}catch(f){}return d};this.callCallback=function(g,f,e,d){if(typeof g=="function"){if(typeof f=="undefined"){return g()}if(typeof e=="undefined"){return g(f)}if(typeof d=="undefined"){return g(f,e)}return g(f,e,d)}else{if(typeof g=="string"){if(g.match(/^flash\:/)){if(typeof f=="undefined"){return b._callASCallback(g)}if(typeof e=="undefined"){return b._callASCallback(g,f)}if(typeof d=="undefined"){return b._callASCallback(g,f,e)
}return b._callASCallback(g,f,e,d)}}}};this._callASCallback=function(k,h,g,f){var d;if(typeof k!="string"){return false}callbackId=k.split("flash:").join("");d=b.getFlashObject();if(d!=null){try{d.focus();if(typeof h=="undefined"){return d.mpApiCallback(callbackId)}if(typeof g=="undefined"){return d.mpApiCallback(callbackId,h)}if(typeof f=="undefined"){return d.mpApiCallback(callbackId,h,g)}d.mpApiCallback(callbackId,h,g,f)}catch(j){}}};this._callASEvent=function(f){var d;if(typeof f!="string"){return false}d=b.getFlashObject();if(d instanceof Object&&typeof d.mpApiEvent instanceof Function){try{d.focus();d.mpApiEvent(f)}catch(g){}}};this.environment=new function(){var d=false;this._assertApp=function(){if(!b.is_internal){b.debug("Not inside our site. Environment module not available.");return false}return true};this.toComments=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.toComments();return true};this.toSimilarGames=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.toSimilarGames();return true};this.toHighscoreGlobal=function(f,e){if(!b.environment._assertApp()){return null}if(typeof e=="undefined"||e==null){e="total"}b.xdm._rpc.toHighscoreGlobal(f,e);return true};this.toHighscoreFriends=function(e){if(!b.environment._assertApp()){return null}b.xdm._rpc.toHighscoreFriends(e);return true};this.toAchievements=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.toAchievements();return true};this.toControls=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.toControls();return true};this.highlightLikeGame=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.highlightLikeGame();return true};this.highlightFavGame=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.highlightFavGame();return true};this.highlightAchievements=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.highlightAchievements();return true};this.toDescription=function(){if(!b.environment._assertApp()){return null
}b.xdm._rpc.toDescription();return true};this.toSagaGames=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.toSagaGames();return true};this.toCollectionGames=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.toCollectionGames();return true};this.toUserShare=function(f,e,g){if(!b.environment._assertApp()){return null}d=g;b.xdm._rpc.toUserShare(f,e);return true};this.toUserChallenge=function(h,f,g,e,j){if(!b.environment._assertApp()){return null}d=j;b.xdm._rpc.toUserChallenge(h,f,g,e);return true};this.onShareCallback=function(e,f){if(d&&typeof d=="function"){var g=d;d=false;g(e,f)}};this.getLocale=function(){return b.locale};this.getLocaleLang=function(){return b.locale_lang};this.isInternal=function(){return b.is_internal};this.isExternal=function(){return b.is_external};this.isMobile=function(){return b.is_mobile};this.player=new function(){this.maximize=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.maximize()};this.minimize=function(){if(!b.environment._assertApp()){return null}b.xdm._rpc.minimize()};this.isScalable=function(){if(!b.environment._assertApp()){return null}if(b.environment.player.isResizable()){return false}return b._player.is_scalable};this.isResizable=function(){if(!b.environment._assertApp()){return null}return b._player.is_resizable};this.getCurrentSize=function(){if(!b.environment._assertApp()){return null}return b._player.current_size};this.getSize=function(){if(!b.environment._assertApp()){return null}return b._player.size};this.getViewType=function(){if(!b.environment._assertApp()){return null}return b._player.view_type};this.getCurrentViewType=function(){if(!b.environment._assertApp()){return null}return b._player.current_view_type};this.isMaximized=function(){if(!b.environment._assertApp()){return null}return b._player.is_maximized};this.setSize=function(f,e){if(!this.isResizable()){throw new Error("You don't have enough permissions to resize the player frame. Contact us to request access.")
}if(this.is_external){throw new Error("External integration, method not available")}if(this.getViewType=="fullscreen"){throw new Error("Game in fullscreen mode, not resizable.")}b.xdm._rpc.setSize(f,e);return true};this.resetSize=function(){if(!this.isResizable()){throw new Error("You don't have enough permissions to resize the player frame. Contact us to request access.")}if(this.is_external){throw new Error("External integration, method not available")}if(this.getViewType=="fullscreen"){throw new Error("Game in fullscreen mode, not resizable.")}b.xdm._rpc.resetSize();return true};this.setViewportScale=function(e){if(this.is_external){throw new Error("External integration, method not available")}if(!b.is_mobile){throw new Error("Only available for mobile sites")}b.xdm._rpc.setViewportScale(e);return true};this.showOverlay=function(){if(this.is_external){throw new Error("External integration, method not available")}if(!b.is_mobile){throw new Error("Only available for mobile sites")}b.xdm._rpc.showOverlay();return true};this.hideOverlay=function(){if(this.is_external){throw new Error("External integration, method not available")}if(!b.is_mobile){throw new Error("Only available for mobile sites")}b.xdm._rpc.hideOverlay();return true}}};this.unity=new function(){var d=this;var g;var e="";var f=function(){if(!g){if(window.hasOwnProperty("gameInstance")){g=window.gameInstance}else{if(window.hasOwnProperty("unityInstance")){g=window.unityInstance}else{if(typeof window.SendMessage==="function"){g={SendMessage:window.SendMessage}}}}}if(g){if(!b.is_unity){b.is_unity=true}return g}else{if(b.is_unity){b.warn("Unable to find UNITY gameInstance, make sure window.gameInstance or window.unityInstance contains the UNITY GAME INSTANCE. More INFO at https://ssl.miniplay.com/dev/docs/c2s-unity-api#api-loading")}return false}};this.isUnity=function(){return b.is_unity};this.gamePause=function(){d.sendRawMessage("gamePause")};this.gameResume=function(){d.sendRawMessage("gameResume")};this.sendApiReadyMessage=function(){if(f()){b.debug("UNITY instance found... sending onJSApiReady");
f().SendMessage("LeChuckAPI","_onJSMessage","apiReady")}else{if(b.is_unity){b.debug("Unable send message to UNITY gameInstance")}}};this.sendRawMessage=function(h){if(typeof h!="string"){return false}b.debug("SendRawUnityMessage => "+JSON.stringify(h));if(f()){f().SendMessage("LeChuckAPI","_onJSMessage",h);window.focus()}else{if(b.is_unity){b.debug("Unable send raw message to UNITY gameInstance:\n"+h)}}};this.sendMessage=function(k,h){var j;if(h===undefined){h=null}if(k===undefined){k=null}if(h&&typeof h=="object"){if(h.hasOwnProperty("errorType")&&h.errorType===false){h.errorType=""}if(h.hasOwnProperty("errorMessage")&&h.errorMessage===false){h.errorMessage=""}}j=k+"~|#|~";if(typeof h!="string"){j+=JSON.stringify(h);b.debug("SendUnityMessage => "+JSON.stringify(JSON.stringify(h)))}else{b.debug("SendUnityMessage => "+JSON.stringify(h));j+=h}if(f()){f().SendMessage("LeChuckAPI","_onJSMessage",j);window.focus()}else{if(b.is_unity){b.debug("Unable send message to UNITY gameInstance:\n"+JSON.stringify(JSON.stringify(h)))}}};this.attachOnApiReady=function(){c.events.onApiReady(function(){d.sendApiReadyMessage()})};this.onApiReady=function(h){c.events.onApiReady(function(){d.sendMessage(h)})};this.onUserDisconnect=function(h){c.events.onUserDisconnect(function(){d.sendMessage(h)})};this.onPlayerResize=function(h){c.events.onPlayerResize(function(){d.sendMessage(h)})};this.getInfo=function(j){var h={apiId:b.id,apiVersion:b._version,site:b.site,locale:b.locale,lang:b.locale_lang,isMobile:b.is_mobile,isInternal:b.is_internal,isExternal:b.is_external,host:document.location.host,payload:b.clientPayload};d.sendMessage(j,h)};this.getCurrentUser=function(k){var h="https://www.minijuegosgratis.com/users/avatars/default_boy/";var j={success:true,errorType:null,errorMessage:null,id:c.user.getId(),uid:c.user.getUid(),level:c.user.getLevel()||0,avatar:c.user.getAvatar()||h+"head_96x96.jpg",avatarBig:c.user.getAvatarBig()||h+"head_256x256.jpg",avatarMini:c.user.getAvatarMini()||h+"head_32x32.jpg",avatarBody:c.user.getAvatarBody()||h+"body_160x220.png",avatarAlpha:c.user.getAvatarAlpha()||h+"head_96x96.png",profile:c.user.getProfile(),isGuest:c.user.isGuest(),token:c.user.getToken()};
d.sendMessage(k,j)};this.getUser=function(k,j){var h=parseInt(j[0]);c.user.get(function(m){var l={success:!!m.userData,errorType:m.errorType,errorMessage:m.errorMessage,id:null,uid:null,level:null,avatar:null,avatarBig:null,avatarMini:null,avatarBody:null,avatarAlpha:null,profile:null,isGuest:true};if(m.userData){l.id=parseInt(m.userData.id,10);l.uid=m.userData.uid;l.level=m.userData.progress_level;l.avatar=m.userData.avatar;l.avatarBig=m.userData.avatar_big;l.avatarMini=m.userData.avatar_mini;l.avatarBody=m.userData.avatar_body;l.avatarAlpha=m.userData.avatar_alpha;l.profile=m.userData.profile;l.isGuest=false}d.sendMessage(k,l)},h)};this.login=function(){c.user.login()};this.register=function(){c.user.register()};this.getStat=function(k,j){var h=j[0];c.stat.get(function(l){l.uid=h;d.sendMessage(k,l)},h)};this.putStat=function(l,j){var h=j[0];var k=parseInt(j[1],10);c.stat.put(function(m){m.uid=h;d.sendMessage(l,m)},h,k)};this.getSize=function(h){d.sendMessage(h,c.environment.player.getCurrentSize())};this.showComments=function(){c.environment.toComments()};this.showControls=function(){c.environment.toControls()};this.showDescription=function(){c.environment.toDescription()};this.showAchievements=function(){c.environment.toAchievements()};this.maximizePlayer=function(){c.environment.player.maximize()};this.minimizePlayer=function(){c.environment.player.minimize()};this.share=function(l,h){var k=String(h[0]).split(",");var j=c.environment.toUserShare(k,{},function(n,m){d.sendMessage(l,{success:n,users:m})});if(!j){d.sendMessage(l,{success:false,users:[]})}};this.challenge=function(p,m){var l=m[1]==1;var k=m[2]==1;var j=String(m[0]).split(",");var h;try{h=JSON.parse(m[3]);if(typeof h!="object"){h={}}}catch(n){b.warn("Error parsing custom parameters JSON: "+m[1]+" "+n)}var o=c.environment.toUserChallenge(j,k,l,h,function(s,r){var q={success:s,users:r};d.sendMessage(p,q)});if(!o){d.sendMessage(p,{success:false,users:[]})}};this.vrHasCampaigns=function(k,h){var j=h[0];c.ads.videoRewards.hasCampaigns(j,function(){d.sendMessage(k,{hasCampaigns:true})
},function(){d.sendMessage(k,{hasCampaigns:false})})};this.vrShowAd=function(n,m){var l="";var k=false;var h={};if(m!==undefined&&m instanceof Array&&m.length>0){l=m[0];if(m.length>1&&(m[1]=="true"||m[1]==1)){k=true}if(m.length>3){h=new Function("return "+m[2])()}}if(typeof h!="object"){h={}}var j=c.ads.videoRewards.showAd(function(){d.sendMessage(n,"open")},function(){d.sendMessage(n,"close")},function(){d.sendMessage(n,"complete")},k,l,h);if(!j){d.sendMessage(n,"close")}};this.showInterlevelAd=function(m,l,k,h){var j="";if(l!==undefined&&l instanceof Array&&l.length>0){j=l[0];if(l.length>1&&k==undefined&&(l[1]==1||l[1])){k=true}if(l.length>2&&h==undefined){h=l[2]}}if(k==undefined){k=false;if(c.ads&&c.ads.hasOwnProperty("forceCampaignDefault")){k=c.ads.forceCampaignDefault}}if(h==undefined){h={};if(c.ads&&c.ads.hasOwnProperty("defaultCampaignOptions")){h=c.ads.defaultCampaignOptions}}c.ads.showInterlevelAd(j,function(){d.sendMessage(m,{adEvent:"start"})},function(){d.sendMessage(m,{adEvent:"endOk"})},function(){d.sendMessage(m,{adEvent:"endKo"})},k,h)};this.getCurrentUserFriends=function(k,j){var h={limit:20,toTimestamp:null,withDetail:true,withInstalled:true,withProgress:true};if(j.length>0&&String(j[0]).length>0){h.limit=parseInt(String(j[0]),10)}if(j.length>1&&j[1].length>0){h.toTimestamp=j[1]}c.user.friends(function(o){var l={success:!o.errorType,errorType:o.errorType,errorMessage:o.errorMessage,friends:null};if(!o.errorType&&o.friends){l.friends=[];for(var m=0;m<o.friends.length;m++){var n=o.friends[m];l.friends.push({id:n.id,uid:n.uid,avatar:n.avatar,avatarBig:n.avatar_big,avatarMini:n.avatar_mini,avatarBody:n.avatar_body,avatarAlpha:n.avatar_alpha,isInstalled:n.is_installed,profile:n.profile,timestamp:n.time,level:n.progress_level})}}d.sendMessage(k,l)},h)};this.itemDetail=function(k,h){var j=h[0];c.item.detail(function(m){var l={success:!m.errorType,errorType:m.errorType,errorMessage:m.errorMessage,item:null};if(!m.errorType&&m.item){l.item=m.item}d.sendMessage(k,l)
},j)};this.itemList=function(h){c.item.list(function(k){var j={success:!k.errorType,errorType:k.errorType,errorMessage:k.errorMessage,items:[]};if(k.items){j.items=k.items}d.sendMessage(h,j)})};this.itemInventory=function(h){c.item.inventory(function(k){var j={success:!k.errorType,errorType:k.errorType,errorMessage:k.errorMessage,items:[]};if(k.items){j.items=k.items}d.sendMessage(h,j)})};this.itemStock=function(k,h){var j=h[0];c.item.stock(function(m){var l={success:!m.errorType,errorType:m.errorType,errorMessage:m.errorMessage,stock:0,timestamp:null,item:null};if(!m.errorType){if(m.item){l.item=m.item}l.stock=m.stock;l.timestamp=m.timestamp}d.sendMessage(k,l)},j)};this.itemBuy=function(m,j){var l=j[0];var k;if(l=="dynamic"){k=j[1]}else{k=parseInt(j[1],10)}var h={};h[l]=k;c.item.buy(function(o){var n={success:!o.errorType,errorType:o.errorType,errorMessage:o.errorMessage,items:null};if(!o.errorType){if(o.items){n.items=o.items}}d.sendMessage(m,n)},h)};this.itemConsume=function(l,h){var k=h[0];var j=parseInt(h[1],10);c.item.eat(function(n){var m={success:!n.errorType,errorType:n.errorType,errorMessage:n.errorMessage,uid:k,new_stock:null};if(!n.errorType){if(n.item){m.uid=n.item.uid}m.new_stock=parseInt(n.newStock,0)}d.sendMessage(l,m)},k,j)};this.setUnityApiVersion=function(h){e=String(h)}};this.getUniqueId=function(d,h){if(typeof h=="undefined"){h=function(){}}if(typeof d=="undefined"){d=""}var e=b.url+"client/unique-id?seed="+d;var f=b.newXhr("GET",e,true);var g="";if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){var j=new Function("return "+f.responseText)();if(j&&j.hasOwnProperty("data")&&j.data&&j.data.hasOwnProperty("uniqueId")){g=j.data.uniqueId}h(g)}};f.send(null)}else{h(null)}};this.ads=new function(){var d=this;this._init=false;this._initOk=false;this.adManager=null;this.forceCampaignDefault=true;this.defaultCampaignOptions={fallbackTrackId:"ZJAF1MJGAMEPUPPET",fallbackTrackSubId:"intersttl"};this.videoRewards=new function(){var e=this;
var f=null;var k="u"+Math.random();var g=false;var h=false;var j=function(n,m,l){if(typeof n=="undefined"||n==null||n==""){n="6f52de6d"}if(typeof m=="undefined"){m=function(){b.debug("Ads video rewards default callback ok - Has campaigns")}}if(typeof l=="undefined"){l=function(){b.debug("Ads video rewards default callback ko - Doesn't have campagins")}}if(g){if(h){m()}if(!h){l()}return}if(f==null&&false){b.getUniqueId("",function(o){k=o;var p="https://static.ultra-rv.com/rv-min.js";b.debug("Ads. Video rewards ad Manager init for client "+k+": Step 1 "+p);b.getScript(p,function(){b.debug("Ads. Video rewards ad Manager init for client "+k+": Step 3");f=IronRV.getInstance({applicationKey:n,applicationUserId:k});if(f!=null&&f!=undefined){f.removeListener(IronRV.EVENTS.READY);f.removeListener(IronRV.EVENTS.NO_CAMPAIGNS);f.addListener(IronRV.EVENTS.READY,function(){h=true;if(!g){g=true;m()}});f.addListener(IronRV.EVENTS.NO_CAMPAIGNS,function(){h=false;if(!g){g=true;l()}});f.addListener(IronRV.EVENTS.INIT_ERROR,function(){h=false;if(!g){g=true;l()}});b.debug("Ads Manager events registered OK")}else{b.debug("Ads Manager loaded KO");l()}},function(){b.debug("Ads Manager loaded KO");l()})})}else{if(!g){b.debug("No adManager");g=true;h=false;l()}else{b.debug("Already initialized")}}};this.hasCampaigns=function(n,m,l){if(typeof n=="undefined"){n=null}if(typeof m=="undefined"){m=function(){b.debug("Ads video rewards default callback ok - Has campaigns")}}if(typeof l=="undefined"){l=function(){b.debug("Ads video rewards default callback ko - Doesn't have campagins")}}j(n,function(){b.debug("Ads video rewards HAS CAMPAIGNS");m()},function(){b.debug("Ads video rewards DOESN'T HAVE CAMPAIGNS");l()})};this.showAd=function(n,s,l,o,m,q){if(typeof o=="undefined"){o=false}o=true;if(typeof m=="undefined"||m===""){var t=[];m="https://ext.minijuegos.com/video/tags.php?lng="+b.locale_lang+"&type="+(b.is_mobile?"mobile":"desktop")+"&id="+b.getGameUid()+"&site="+encodeURIComponent(b.site_https)+"&rnd="+Math.random()
}if(typeof q=="undefined"){q={}}if(typeof n=="undefined"){n=function(){b.debug("Ads video rewards default callback open")}}if(typeof s=="undefined"){s=function(){b.debug("Ads video rewards default callback close")}}if(typeof l=="undefined"){l=function(){b.debug("Ads video rewards default callback complete")}}if(!g){var r=function(){e.showAd(n,s,l,o,m,q)};var p=null;if(q.hasOwnProperty("appKey")){p=q.appKey}j(p,r,r);return true}if(g&&h&&f!=null&&f!=undefined){f.removeListener(IronRV.EVENTS.OPEN);f.removeListener(IronRV.EVENTS.CLOSE);f.removeListener(IronRV.EVENTS.COMPLETION);f.addListener(IronRV.EVENTS.OPEN,function(){b.debug("IRONRV Opened");n()});f.addListener(IronRV.EVENTS.CLOSE,function(){b.debug("IRONRV Closed");s()});f.addListener(IronRV.EVENTS.COMPLETION,function(){b.debug("IRONRV Completion");l()});f.show();return true}else{if(o){d.showInterlevelAd(m,n,function(){l();s()},s,true,q);return true}else{b.debug("No campaigns available");return false}}}};this.showInterlevelAd=function(f,g,l,k,j,e){try{if(typeof f!="undefined"?f:null){}if(typeof g!="undefined"?g:null){}if(typeof l!="undefined"?l:null){}if(typeof k!="undefined"?k:null){}if(typeof j=="undefined"){j=d.forceCampaignDefault}if(typeof e=="undefined"||!e.hasOwnProperty("fallbackTrackId")){e=d.defaultCampaignOptions}e=b.extendOptions({fallbackTrackId:"ZJAF1MJGAMEPUPPET",fallbackTrackSubId:"intersttl"},e);if(f){f=f.split("{random}").join(Math.random());f=f.split("{rnd}").join(Math.random());f=f.split("[random]").join(Math.random());f=f.split("[rnd]").join(Math.random());f=f.split("{time}").join(Date.now());f=f.split("[time]").join(Date.now());f=f.split("[lang]").join(b.locale_lang);f=f.split("{lang}").join(b.locale_lang)}b.debug("ShowInterlevelAd request, tagUrl: "+f+". trackId "+e.fallbackTrackId);if(!d._init){d.init(function(){d.showInterlevelAd(f,g,l,k,j,e)}.bind(d));return}if(d._initOk&&d.adManager){d.adManager.showInterlevelAd(f,g,l,k,j,e)}else{b.debug("ShowInterlevelAd cannot be executed. AdManager not initialized.");
if(k){k()}}}catch(h){b.debug("ShowInterlevelAd error: "+h);if(k){k()}}};this.initComplete=function(f,e){b.debug("Ads Manager initComplete "+(f?"OK":"KO"));d._initOk=f;if(e){e(d)}};this.init=function(f){var e=b.getBaseUrl()+"ads/googima_v4.01.js";d._init=true;d._initOk=false;b.debug("Ads init. Ad Manager: "+e);b.getScript(e,function(){b.debug("Ads Manager loaded OK");d.adManager.init(b,d.initComplete,f,b.enableDebug)},function(){b.debug("Ads Manager loaded KO");d.initComplete(false,d.initComplete,f)})}};this.items=new function(){this._logWatcherInstance=false;this._logWatcherCallback=false;this._logWatcherPollTime=10000;this._logWatcherStartTime=false;this._logWatcherTimeout=900;this._logWatcherLastTimestamp=0;this.watch=function(d){if(typeof d!="function"){return false}b.items.unwatch();b.items._logWatcherStartTime=new Date().getTime()/1000;b.items._logWatcherCallback=d;b.debug("Item Watcher Started. New operations will be sent to the watcher callback");b.items._watchJob();return true};this._watchJob=function(){b.items.userLog(function(d){if(d.errorType!=false){return}if(d.size>0&&b.items._logWatcherLastTimestamp>0&&b.items._logWatcherCallback){b.callCallback(b.items._logWatcherCallback,d.log)}b.items._logWatcherLastTimestamp=d.lastTimestamp;if(b.items._logWatcherLastTimestamp==0){b.items._logWatcherLastTimestamp=1}if(new Date().getTime()/1000>=(b.items._logWatcherStartTime+b.items._logWatcherTimeout)){b.debug("Item Watcher Stopped (timeout reached)");b.items.unwatch()}else{b.items._logWatcherInstance=setTimeout(b.items._watchJob,b.items._logWatcherPollTime)}},{limit:b.items._logWatcherLastTimestamp>0?99:1,stopTimestamp:b.items._logWatcherLastTimestamp})};this.unwatch=function(){if(b.items._logWatcherInstance){clearTimeout(b.items._logWatcherInstance);b.debug("Item Watcher Stopped")}b.items._logWatcherInstance=false;b.items._logWatcherStartTime=false;b.items._logWatcherCallback=false;b.items._logWatcherLastTimestamp=0};this.list=function(f){var d,e;if((typeof f=="undefined"||f==null)){f=function(){}
}if(!b.id){response=new b.items._listResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id";return b.callCallback(f,response)}d=b.url+"item/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale;e=b.newXhr("GET",d,true);if(e){e.onreadystatechange=function(){if(e.readyState==4&&e.responseText!=""){data=new Function("return "+e.responseText)();response=new b.items._listResponse();if(data.status.success){response.items=data.data.items}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(f,response)}};e.send(null);return true}else{return false}};this._listResponse=function(){this.items=false;this.errorType=false;this.errorMessage=false};this.detail=function(g,d){var e,f;if((typeof g=="undefined"||g==null)){g=function(){}}if(typeof d=="undefined"){d=false}if(!b.id||!d){response=new b.items._detailResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id or item_uid";return b.callCallback(g,response)}e=b.url+"item/"+d+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale;f=b.newXhr("GET",e,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.items._detailResponse();if(data.status.success){response.item=data.data.item}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};f.send(null);return true}else{return false}};this._detailResponse=function(){this.item=false;this.errorType=false;this.errorMessage=false};this.inventory=function(g,e){var d,f;if((typeof g=="undefined"||g==null)){g=function(){}}if(!b.id||!b.user_id||!b.user_token){response=new b.items._inventoryResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user_id or user_token";return b.callCallback(g,response)}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({withDetail:true},e);d=b.url+"item/"+b.user_id+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;
if(e.withDetail){d+="&withDetail=1"}f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.items._inventoryResponse();if(data.status.success){response.items=data.data.items}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};f.send(null);return true}else{return false}};this._inventoryResponse=function(){this.items=false;this.errorType=false;this.errorMessage=false};this.stock=function(h,d,f){var e,g;if((typeof h=="undefined"||h==null)){h=function(){}}if(typeof d=="undefined"){d=false}if(!b.id||!b.user_id||!b.user_token||!d){response=new b.items._stockResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, item_uid, or user_id";return b.callCallback(h,response)}if((typeof f=="undefined"||f==null)){f=false}f=b.extendOptions({withDetail:true},f);e=b.url+"item/"+b.user_id+"/"+d+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;if(f.withDetail){e+="&withDetail=1"}g=b.newXhr("GET",e,true);if(g){g.onreadystatechange=function(){if(g.readyState==4&&g.responseText!=""){data=new Function("return "+g.responseText)();response=new b.items._stockResponse();if(data.status.success){if(typeof data.data.item!="undefined"){response.item=data.data.item}response.stock=data.data.stock;response.timestamp=data.data.timestamp}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};g.send(null);return true}else{return false}};this._stockResponse=function(){this.item=false;this.stock=false;this.timestamp=false;this.errorType=false;this.errorMessage=false};this.eat=function(j,d,h,f){var e,g;if((typeof j=="undefined"||j==null)){j=function(){}}if(typeof d=="undefined"){d=false}if(typeof h=="undefined"){h=1}if(!b.id||!b.user_id||!b.user_token||!d){response=new b.items._eatResponse();response.errorType="MISSING_DATA";
response.errorMessage="No api id, item_uid, or user_id";return b.callCallback(j,response)}if((typeof f=="undefined"||f==null)){f={}}f=b.extendOptions({withDetail:true},f);e=b.url+"item/"+b.user_id+"/"+d+"/eat?qty="+h+"&api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;if(f.withDetail){e+="&withDetail=1"}g=b.newXhr("GET",e,true);if(g){g.onreadystatechange=function(){if(g.readyState==4&&g.responseText!=""){data=new Function("return "+g.responseText)();response=new b.items._eatResponse();if(data.status.success){if(typeof data.data.item!="undefined"){response.item=data.data.item}response.newStock=data.data.new_stock}else{response.errorType=data.status.type;response.errorMessage=data.status.message;if(data.hasOwnProperty("exception")&&data.exception){response.errorType=data.exception.type;response.errorMessage=data.exception.message}}return b.callCallback(j,response)}};g.send(null);return true}else{return false}};this._eatResponse=function(){this.item=false;this.newStock=null;this.errorType=false;this.errorMessage=false};this.userLog=function(g,e){var d,f;if((typeof g=="undefined"||g==null)){g=function(){}}if(typeof item_uid=="undefined"){item_uid=false}if(!b.id||!b.user_id||!b.user_token){response=new b.items._userLogResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id or user_id";return b.callCallback(g,response)}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({limit:20,startTimestamp:0,stopTimestamp:0},e);d=b.url+"item/"+b.user_id+"/log/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;d+="&limit="+e.limit;d+="&startTimestamp="+e.startTimestamp;d+="&stopTimestamp="+e.stopTimestamp;f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.items._userLogResponse();if(data.status.success){response.log=data.data.log;response.size=data.data.log.length;
response.lastTimestamp=data.data.lastTimestamp}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};f.send(null);return true}else{return false}};this._userLogResponse=function(){this.log=false;this.size=false;this.lastTimestamp=false;this.errorType=false;this.errorMessage=false};this.buy=function(k,f){var g,h;var e="";if((typeof k=="undefined"||k==null)){k=function(){}}if(typeof f=="string"&&f!=""){f=new Function("return "+f)()}if(typeof f=="object"){for(var j in f){try{e+="&item_"+j+"="+encodeURIComponent(f[j])}catch(d){}}}if(!b.id||!b.user_id||!b.user_token||e==""){response=new b.items._buyResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user_id or items to buy!";return b.callCallback(k,response)}b._buyItemsCallback=k;g=b._getMatchingSite()+"game/buyItems/?api=lechuck&version="+b.getVersion()+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&api_id="+b.id+"&user_id="+b.user_id+"&user_token="+b.user_token+e+"&origin="+encodeURI(document.location.protocol+"//"+document.location.host);h="screenX=100,screenY=100,height=150,width=300,status=no,titlebar=yes,toolbar=no,resizable=no,location=yes,menubar=no";if(b.xdm._connected){if(b.is_internal){b.xdm._rpc.openBuyItems(g,"miniplay",h,document.location.protocol+"//"+document.location.host)}else{if(navigator.appVersion.indexOf("MSIE")!=-1){b.xdm._rpc.openBuyItems(g,"miniplay",h,document.location.protocol+"//"+document.location.host)}else{win=window.open(b._getMatchingSite()+"helpers/game/blank.php?locale="+b.locale,"miniplay",h);setTimeout(function(){b.xdm._rpc.openBuyItems(g,"miniplay",h,document.location.protocol+"//"+document.location.host)},300)}}}else{response=new b.items._buyResponse();response.success=false;response.errorType="NO_XDM";response.errorMessage="No cross domain connection";b.callCallback(k,response);b._buyItemsCallback=false}};this._buyCompleted=function(d){b.debug("Buy completed");if(!b._buyItemsCallback){return
}response=new b.items._buyResponse();if(d instanceof Array&&d.length>0){response.success=true;response.items=d}else{response.success=false;response.errorType="CANCELLED";response.errorMessage="User cancelled"}b.callCallback(b._buyItemsCallback,response);b._buyItemsCallback=false};this._buyResponse=function(){this.success=false;this.items=false;this.errorType=false;this.errorMessage=false}};this.highscore=new function(){this.global=function(h,g,e){var d,f;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof g=="undefined"||g==null)){g=false}if(!b.id||!g){response=new b.stat._globalResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id or hs_uid";return b.callCallback(h,response)}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({withProgress:false,withDetail:true,withSharedContent:false,timespan:"TOTAL",startScore:"",startTimestamp:"",limit:20},e);d=b.url+"highscore/"+g+"/global/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale;if(e.withDetail){d+="&withDetail=1"}if(e.withProgress){d+="&withProgress=1"}if(e.withSharedContent){d+="&withSharedContent=1"}d+="&limit="+e.limit;d+="&startScore="+e.startScore;d+="&startTimestamp="+e.startTimestamp;d+="&timespan="+e.timespan.toUpperCase();f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.highscore._globalResponse();if(data.status.success){response.highscore=data.data.highscore;response.scores=data.data.scores}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};f.send(null);return true}else{return false}};this._globalResponse=function(){this.highscore=false;this.scores=false;this.errorType=false;this.errorMessage=false};this.friends=function(h,g,e){var d,f;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof g=="undefined"||g==null)){g=false}if(!b.id||!b.user_id||!b.user_token||!g){response=new b.stat._friendsResponse();
response.errorType="MISSING_DATA";response.errorMessage="No api id, user_id or hs_uid";return b.callCallback(h,response)}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({withProgress:false,withDetail:true,withSharedContent:false,startScore:"",startUser:"",limit:20},e);d=b.url+"highscore/"+g+"/friends/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_id="+b.user_id+"&user_token="+b.user_token;if(e.withDetail){d+="&withDetail=1"}if(e.withProgress){d+="&withProgress=1"}if(e.withSharedContent){d+="&withSharedContent=1"}d+="&limit="+e.limit;d+="&startScore="+e.startScore;d+="&startUser="+e.startUser;f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.highscore._friendsResponse();if(data.status.success){response.highscore=data.data.highscore;response.scores=data.data.scores}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};f.send(null);return true}else{return false}};this._friendsResponse=function(){this.highscore=false;this.scores=false;this.errorType=false;this.errorMessage=false};this.score=function(h,g,e){var d,f;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof g=="undefined"||g==null)){g=false}if(!b.id||!b.user_id||!b.user_token||!g){response=new b.stat._scoreResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user_id or hs_uid";return b.callCallback(h,response)}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({timespan:"TOTAL",withSharedContent:false},e);d=b.url+"highscore/"+g+"/score/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_id="+b.user_id+"&user_token="+b.user_token;d+="&timespan="+e.timespan.toUpperCase();if(e.withSharedContent){d+="&withSharedContent=1"}f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();
response=new b.highscore._scoreResponse();if(data.status.success){response.highscore=data.data.highscore;response.value=data.data.value;response.timestamp=data.data.timestamp;if(e.withSharedContent){response.sharedContentId=data.data.sharedContentId}}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};f.send(null);return true}else{return false}};this._scoreResponse=function(){this.highscore=false;this.value=false;this.timestamp=false;this.sharedContentId=false;this.errorType=false;this.errorMessage=false};this.position=function(g,f){var d,e;if((typeof g=="undefined"||g==null)){g=function(){}}if((typeof f=="undefined"||f==null)){f=false}if(!b.id||!b.user_id||!b.user_token||!f){response=new b.stat._positionResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user_id or hs_uid";return b.callCallback(g,response)}d=b.url+"highscore/"+f+"/position/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_id="+b.user_id+"&user_token="+b.user_token;e=b.newXhr("GET",d,true);if(e){e.onreadystatechange=function(){if(e.readyState==4&&e.responseText!=""){data=new Function("return "+e.responseText)();response=new b.highscore._positionResponse();if(data.status.success){response.highscore=data.data.highscore;response.value=data.data.value;response.timestamp=data.data.timestamp}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};e.send(null);return true}else{return false}};this._positionResponse=function(){this.highscore=false;this.value=false;this.timestamp=false;this.errorType=false;this.errorMessage=false}};this.stat=new function(){this.get=function(g,f){var d,e;if((typeof g=="undefined"||g==null)){g=function(){}}if((typeof f=="undefined"||f==null)){f=false}if(!b.id||!b.user_id||!b.user_token||!f){response=new b.stat._getResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user_id, user_token or stat_uid";
return b.callCallback(g,response)}d=b.url+"stat/"+f+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_id="+b.user_id+"&user_token="+b.user_token;e=b.newXhr("GET",d,true);if(e){e.onreadystatechange=function(){if(e.readyState==4&&e.responseText!=""){data=new Function("return "+e.responseText)();response=new b.stat._getResponse();if(data.status.success){if(!data.data.hasOwnProperty("result")){data.data.result={statValue:null}}response.success=true;response.stat=data.data.stat;response.value=data.data.value||data.data.result.statValue;response.timestamp=data.data.timestamp}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};e.send(null);return true}else{return false}};this.put=function(l,k,f){var e,j;if((typeof l=="undefined"||l==null)){l=function(){}}if((typeof k=="undefined"||k==null)){k=false}if((typeof f=="undefined"||f==null)){f=false}if(!b.id){var d=new b.stat._getResponse();if(b.anonymousMode){d.errorType="MISSING_DATA";d.errorMessage="The API is working on anonymous mode and the API id couldn't be detected. No stats allowed."}else{d.errorType="MISSING_DATA";d.errorMessage="No API id provided."}return b.callCallback(l,d)}if(!b.user_id||!b.user_token||!k||!f){var d=new b.stat._getResponse();d.errorType="MISSING_DATA";d.errorMessage="No API id, user_id, user_token, stat value or stat_uid";return b.callCallback(l,d)}var h={api_id:b.id,user_id:b.user_id,locale:b.locale,user_token:b.user_token,value:f};var g=base64_encode(JSON.stringify(h));e=b.url+"stat/"+k+"/put/?p="+g;j=b.newXhr("GET",e,true);if(j){j.onreadystatechange=function(){if(j.readyState==4&&j.responseText!=""){data=new Function("return "+j.responseText)();d=new b.stat._getResponse();if(data.status.success){if(!data.data.hasOwnProperty("result")){data.data.result={statValue:null}}d.success=true;d.stat=data.data.stat;d.value=data.data.value||data.data.result.statValue;d.timestamp=data.data.timestamp}else{d.errorType=data.status.type;
d.errorMessage=data.status.message}return b.callCallback(l,d)}};j.send(null);return true}else{return false}};this.batch=function(k,f){var e,j;if((typeof k=="undefined"||k==null)){k=function(){}}if((typeof f=="undefined"||f==null)){f=false}if(!b.id){var d=new b.stat._getResponse();if(b.anonymousMode){d.errorType="MISSING_DATA";d.errorMessage="The API is working on anonymous mode and the API id couldn't be detected. No stats allowed."}else{d.errorType="MISSING_DATA";d.errorMessage="No API id provided."}return b.callCallback(k,d)}if(!b.id||!b.user_id||!b.user_token||!f){d=new b.stat._getResponse();d.errorType="MISSING_DATA";d.errorMessage="No api id, user_id, user_token or batch..";return b.callCallback(k,d)}var h={api_id:b.id,user_id:b.user_id,locale:b.locale,user_token:b.user_token,stats:f};var g=base64_encode(JSON.stringify(h));e=b.url+"stat/batch/?p="+g;j=b.newXhr("GET",e,true);if(j){j.onreadystatechange=function(){if(j.readyState==4&&j.responseText!=""){var m=new Function("return "+j.responseText)();var l=new b.stat._getResponse();if(m.status.success){if(!m.data.hasOwnProperty("result")){m.data.result={statValue:null}}l.success=true;l.stat=m.data.stat;l.value=m.data.value||m.data.result.statValue;l.timestamp=m.data.timestamp}else{l.errorType=m.status.type;l.errorMessage=m.status.message}return b.callCallback(k,l)}};j.send(null);return true}else{return false}};this._getResponse=function(){this.success=false;this.stat=false;this.value=false;this.timestamp=false;this.errorType=false;this.errorMessage=false}};this.datastore=new function(){this.status=function(g){var e,f,d;if((typeof g=="undefined"||g==null)){g=function(){}}if(!b.id||!b.user_id||!b.user_token){d=new b.stat._statusResponse();d.errorType="MISSING_DATA";d.errorMessage="No api id, user_id or user_token";return b.callCallback(g,d)}e=b.url+"datastore/"+b.user_id+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;f=b.newXhr("GET",e,true);if(f){f.onreadystatechange=function(){var h;
if(f.readyState==4&&f.responseText!=""){h=new Function("return "+f.responseText)();d=new b.datastore._statusResponse();if(h.status.success){d.first_free_slot=h.data.first_free_slot;d.slots=h.data.slots}else{d.errorType=h.status.type;d.errorMessage=h.status.message}return b.callCallback(g,d)}};f.send(null);return true}else{return false}};this.load=function(h,f){var e,g,d;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof f=="undefined"||f==null)){f=false}if(isNaN(parseInt(f,10))){f=false}if(!b.id||!b.user_id||!b.user_token||f===false){d=new b.stat._loadResponse();d.errorType="MISSING_DATA";d.errorMessage="No api id, user_id, user_token or bad slot number";return b.callCallback(h,d)}e=b.url+"datastore/"+b.user_id+"/"+f+"/get?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;g=b.newXhr("GET",e,true);if(g){g.onreadystatechange=function(){var j;if(g.readyState==4&&g.responseText!=""){j=new Function("return "+g.responseText)();d=new b.datastore._loadResponse();if(j.status.success){d.data=new Function("return "+base64_decode(j.data.slot_data))()}else{d.errorType=j.status.type;d.errorMessage=j.status.message}return b.callCallback(h,d)}};g.send(null);return true}else{return false}};this.save=function(l,j,h,k){var d,m,g,f;if((typeof l=="undefined"||l==null)){l=function(){}}if((typeof j=="undefined"||j==null)){j=false}if((typeof h=="undefined"||h==null)){h=false}if((typeof k=="undefined"||!k)){k=""}if(isNaN(parseInt(j,10))){j=false}if(!b.id||!b.user_id||!b.user_token||j===false){g=new b.datastore._saveResponse();g.errorType="MISSING_DATA";g.errorMessage="No api id, user_id, user_token or bad slot number";return b.callCallback(l,g)}try{f=base64_encode(JSON.stringify(h))}catch(e){g=new b.datastore._saveResponse();g.errorType="BAD_DATA";g.errorMessage="Data provided could not be serialized into JSON, please make sure the object can be stringified";return b.callCallback(l,g)}d=b.url+"datastore/"+b.user_id+"/"+j+"/put?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token+"&label="+encodeURIComponent(k);
m=b.newXhr("POST",d,true);if(m){m.onreadystatechange=function(){var n;if(m.readyState==4&&m.responseText!=""){n=new Function("return "+m.responseText)();g=new b.datastore._saveResponse();if(n.status.success){g.success=n.data.success;g.writtenBytes=n.data.written_bytes}else{g.errorType=n.status.type;g.errorMessage=n.status.message}return b.callCallback(l,g)}};m.send(f);return true}else{return false}};this.reset=function(h,f){var e,g,d;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof f=="undefined"||f==null)){f=false}if(isNaN(parseInt(f,10))){f=false}if(!b.id||!b.user_id||!b.user_token||f===false){d=new b.stat._resetResponse();d.errorType="MISSING_DATA";d.errorMessage="No api id, user_id, user_token or bad slot number";return b.callCallback(h,d)}e=b.url+"datastore/"+b.user_id+"/"+f+"/reset?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;g=b.newXhr("GET",e,true);if(g){g.onreadystatechange=function(){var j;if(g.readyState==4&&g.responseText!=""){j=new Function("return "+g.responseText)();d=new b.datastore._resetResponse();if(j.status.success){d.success=true}else{d.errorType=j.status.type;d.errorMessage=j.status.message}return b.callCallback(h,d)}};g.send(null);return true}else{return false}};this._loadResponse=function(){this.data=false;this.errorType=false;this.errorMessage=false};this._saveResponse=function(){this.success=false;this.writtenBytes=false;this.errorType=false;this.errorMessage=false};this._resetResponse=function(){this.success=false;this.errorType=false;this.errorMessage=false};this._statusResponse=function(){this.first_free_slot=false;this.slots=[];this.errorType=false;this.errorMessage=false}};this.user=new function(){this.isGuest=function(){if(!b.id||!b.user||!b.user_token){return true}else{return false}};this.register=function(){var d,e;if(!b.user.isGuest()){b.debug("Already logged in");return false}if(b.is_internal){b.xdm._rpc.register()}else{throw new Error("No registration allowed for external integrations")
}return true};this.login=function(){var d,e;if(!b.user.isGuest()){b.debug("Already logged in");return false}if(b.is_internal){b.xdm._rpc.login()}else{b.debug("Miniplay connect!! (locale: "+b.locale+")");d=b._getMatchingSite()+"game/permissions/?api=lechuck&version="+b.getVersion()+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&api_id="+b.id+"&origin="+encodeURI(document.location.protocol+"//"+document.location.host);e="screenX=100,screenY=100,height=150,width=300,status=no,titlebar=yes,toolbar=no,resizable=no,location=yes,menubar=no";if(b.xdm._connected){if(navigator.appVersion.indexOf("MSIE")!=-1){b.xdm._rpc.openBuyItems(d,"miniplay",e,document.location.protocol+"//"+document.location.host)}else{var f=window.open(b._getMatchingSite()+"helpers/game/blank.php?locale="+b.locale,"miniplay",e);if(b.isPopupBlocked(f)){return false}else{setTimeout(function(){b.xdm._rpc.openBuyItems(d,"miniplay",e,document.location.protocol+"//"+document.location.host)},400)}}}else{throw new Error("No cross domain connection, unable to call login")}}return true};this._loginCallback=function(d,e){var f;if(typeof d=="undefined"||(typeof e=="undefined"||e==null)){return false}f=b.removeURLParam(document.location.href,"mp_api_user_id");f=b.removeURLParam(f,"mp_api_user_token");if(document.location.href.match(/\?/)){document.location.href=f+"&mp_api_user_id="+d+"&mp_api_user_token="+e}else{document.location.href=f+"?mp_api_user_id="+d+"&mp_api_user_token="+e}};this._setCurrentData=function(d){b.user_uid=null;b.user_progress_level=null;b.user_avatar=null;b.user_avatar_mini=null;b.user_avatar_big=null;b.user_avatar_alpha=null;b.user_avatar_body=null;b.user_profile=null;if(typeof d=="object"&&d!=null){if(typeof d.uid!="undefined"){b.user_uid=d.uid}if(typeof d.progress_level!="undefined"){b.user_progress_level=d.progress_level}if(typeof d.avatar!="undefined"){b.user_avatar=d.avatar}if(typeof d.avatar_mini!="undefined"){b.user_avatar_mini=d.avatar_mini}if(typeof d.avatar_big!="undefined"){b.user_avatar_big=d.avatar_big
}if(typeof d.avatar_alpha!="undefined"){b.user_avatar_alpha=d.avatar_alpha}if(typeof d.avatar_body!="undefined"){b.user_avatar_body=d.avatar_body}if(typeof d.profile!="undefined"){b.user_profile=d.profile}}};this.die=function(d){if(b.user.isGuest()){return false}if(b.is_internal&&(typeof d=="undefined"||d==false)){if(b.is_internal){b.debug("API cannot log out users when running inside our site, users can log out manually as usual");return false}}b.user._setCurrentData(null);b.debug("User successfully disconnected");b.user_id=false;b.user_token=false;b.user_uid=null;b.user_progress_level=null;b.user_avatar=null;b.eventHandler.triggerEvent("userDisconnect");b._callASEvent("die");return true};this.authenticate=function(h,e,d){var f,g;if((typeof h=="undefined"||h==false||h==null)){h=function(){}}if((typeof e=="undefined"||e==null)){e=b.user_id}if((typeof d=="undefined"||d==null)){d=b.user_token}if(!b.id){response=new b.user._authenticateResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id";return b.callCallback(h,response)}if(!e||!d){response=new b.user._authenticateResponse();response.errorType="MISSING_USER";response.errorMessage="No user_id/user_token provided and there is no user logged in";return b.callCallback(h,response)}f=b.url+"user/"+e+"/authenticate/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+d+"&withProgress=1";g=b.newXhr("GET",f,true);if(g){g.onreadystatechange=function(){if(g.readyState==4){response=new b.user._authenticateResponse();if(g.responseText==""||g.responseText.charAt(0)!="{"){return b.callCallback(h,response)}data=new Function("return "+g.responseText)();if(data.status.success){if(e==b.user_id||!b.user_id){b.user_id=e;b.user_token=d;b.user._setCurrentData(data.data.user)}response.isValid=true;if(b.is_internal){b.xdm._rpc.onApiAuthenticate(b.user_id)}}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};g.send(null);return true
}else{return false}};this.secureAuth=function(f,e,d){if((typeof f=="undefined"||f==false||f==null)){f=function(){}}if((typeof e=="undefined"||e==null)){e=b.user_id}if((typeof d=="undefined"||d==null)){d=b.user_token}return b.user.authenticate(f,e,d);if(!b.id){response=new b.user._authenticateResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id";return b.callCallback(f,response)}if(!e||!d){response=new b.user._authenticateResponse();response.errorType="MISSING_USER";response.errorMessage="No user_id/user_token provided and there is no user logged in";return b.callCallback(f,response)}if(b.xdm._connected){b._xdmGetCallbacks.secureAuth=function(g){response=new b.user._authenticateResponse();if(g==""||g.charAt(0)!="{"){return b.callCallback(f,response)}data=new Function("return "+g)();if(data.status.success){if(e==b.user_id||!b.user_id){b.user_id=e;b.user_token=d;b.user._setCurrentData(data.data.user)}response.isValid=true;if(b.is_internal){b.xdm._rpc.onApiAuthenticate(b.user_id)}}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(f,response)};b.xdm._rpc.get("secureAuth",b.url+"user/"+e+"/authenticate/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+d+"&withProgress=1");return true}else{response=new b.items._authenticateResponse();response.success=false;response.errorType="NO_XDM";response.errorMessage="No cross domain connection";b.callCallback(f,response);return false}};this._authenticateResponse=function(){this.isValid=false;this.errorType=false;this.errorMessage=false};this.get=function(h,e,d){var f,g;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof e=="undefined"||e==null)){e=b.user_id;d=b.user_token}else{if((typeof d=="undefined"||d==null)){d=""}}if((typeof d=="undefined"||d==null)){d=b.user_token}if(!b.id||!e){response=new b.user._getResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id or user id";return b.callCallback(h,response)
}f=b.url+"user/"+e+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+d;g=b.newXhr("GET",f,true);if(g){g.onreadystatechange=function(){if(g.readyState==4&&g.responseText!=""){data=new Function("return "+g.responseText)();response=new b.user._getResponse();if(data.status.success){if(e==b.user_id){b.user._setCurrentData(data.data.user)}response.userData=data.data.user}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};g.send(null);return true}else{return false}};this._getResponse=function(){this.userData=false;this.errorType=false;this.errorMessage=false};this.followers=function(g,e){var d,f;if((typeof g=="undefined"||g==null)){g=function(){}}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({withProgress:false,withDetail:true,limit:20,fromTimestamp:"",toTimestamp:""},e);if(!b.id||!b.user||!b.user_token){response=new b.user._followersResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user id or user_token";return b.callCallback(g,response)}d=b.url+"user/"+b.user_id+"/followers/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;if(e.withDetail){d+="&withDetail=1"}if(e.withProgress){d+="&withProgress=1"}d+="&limit="+e.limit;d+="&fromTimestamp="+e.fromTimestamp;d+="&toTimestamp="+e.toTimestamp;f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.user._followersResponse();if(data.status.success){response.followers=data.data.followers}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};f.send(null);return true}else{return false}};this._followersResponse=function(){this.followers=false;this.errorType=false;this.errorMessage=false};this.subscriptions=function(g,e){var d,f;if((typeof g=="undefined"||g==null)){g=function(){}}if((typeof e=="undefined"||e==null)){e=false
}e=b.extendOptions({withProgress:false,withDetail:true,withInstalled:false,limit:20,fromTimestamp:"",toTimestamp:""},e);if(!b.id||!b.user||!b.user_token){response=new b.user._subscriptionsResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user id or user_token";return b.callCallback(g,response)}d=b.url+"user/"+b.user_id+"/subscriptions/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;if(e.withDetail){d+="&withDetail=1"}if(e.withProgress){d+="&withProgress=1"}if(e.withInstalled){d+="&withInstalled=1"}d+="&limit="+e.limit;d+="&fromTimestamp="+e.fromTimestamp;d+="&toTimestamp="+e.toTimestamp;f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.user._subscriptionsResponse();if(data.status.success){response.subscriptions=data.data.subscriptions}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};f.send(null);return true}else{return false}};this._subscriptionsResponse=function(){this.subscriptions=false;this.errorType=false;this.errorMessage=false};this.subscriptionStatus=function(h,d,e){var f,g;if((typeof h=="undefined"||h==null)){h=function(){}}if((typeof d=="undefined"||d==null)){d=false}if((typeof e=="undefined"||e==null)){e=false}if(!b.id||!b.user||!b.user_token||!d){response=new b.user._subscriptionStatusResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user id, user_token or publisher_id";return b.callCallback(h,response)}f=b.url+"user/"+b.user_id+"/substatus/"+d+"/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token+"&withInstalled="+(e?"1":"0");g=b.newXhr("GET",f,true);if(g){g.onreadystatechange=function(){if(g.readyState==4&&g.responseText!=""){data=new Function("return "+g.responseText)();response=new b.user._subscriptionStatusResponse();if(data.status.success){response.is_subscribed=data.data.is_subscribed;
response.is_friend=data.data.is_friend;response.time=data.data.time;if(typeof data.data.is_installed!="undefined"){response.is_installed=data.data.is_installed}}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(h,response)}};g.send(null);return true}else{return false}};this._subscriptionStatusResponse=function(){this.is_subscribed=false;this.is_friend=false;this.time=false;this.errorType=false;this.errorMessage=false};this.friends=function(g,e){var d,f;if((typeof g=="undefined"||g==null)){g=function(){}}if((typeof e=="undefined"||e==null)){e=false}e=b.extendOptions({withProgress:false,withDetail:true,withInstalled:false,limit:20,fromTimestamp:"",toTimestamp:""},e);if(!b.id||!b.user||!b.user_token){response=new b.user._friendsResponse();response.errorType="MISSING_DATA";response.errorMessage="No api id, user id or user_token";return b.callCallback(g,response)}d=b.url+"user/"+b.user_id+"/friends/?api_id="+b.id+"&mobile="+(b.is_mobile?1:0)+"&locale="+b.locale+"&user_token="+b.user_token;if(e.withDetail){d+="&withDetail=1"}if(e.withProgress){d+="&withProgress=1"}if(e.withInstalled){d+="&withInstalled=1"}d+="&limit="+e.limit;d+="&fromTimestamp="+e.fromTimestamp;d+="&toTimestamp="+e.toTimestamp;f=b.newXhr("GET",d,true);if(f){f.onreadystatechange=function(){if(f.readyState==4&&f.responseText!=""){data=new Function("return "+f.responseText)();response=new b.user._friendsResponse();if(data.status.success){response.friends=data.data.friends}else{response.errorType=data.status.type;response.errorMessage=data.status.message}return b.callCallback(g,response)}};f.send(null);return true}else{return false}};this._friendsResponse=function(){this.friends=false;this.errorType=false;this.errorMessage=false}};this.logAS=new function(){this._log=[];this._levels=["","spam","debug","info","warn","error"];this.log=function(d,e){this._log.push({type:d,msg:e})};this.get=function(f){var e=[];if(typeof f=="undefined"){f=null}for(var d=0;d<this._log.length;
d++){if(f<=this._log[d].type||f==null){e.push("["+this._levels[this._log[d].type]+"] "+this._log[d].msg)}}return e};this.print=function(f){var e;if(typeof f=="undefined"){f=null}e=this.get(f);for(var d=0;d<e.length;d++){if(typeof console=="object"){console.log(e[d])}}}};this.xdm=new function(){var d=this;this._local=false;this._xdmAvailable=false;this._init=false;this._connected=false;this._socket=false;this._rpc=false;this._parent=false;this.isConnected=function(){return d._connected};this.init=function(g){var f,h,e,j;if(typeof g!="function"){g=function(){}}if(d._init){g();return}if(!LeChuckAPIEasyXDMLoaded){b.error("easyXDM is not available yet, unable to initialize API communications, waiting until it's ready");LeChuckAPIEasyXDMOnLoaded=function(){d.init(g)};return false}if(typeof easyXDM!="object"){b.error("easyXDM is not available, unable to initialize API communications");g();return false}if(typeof JSON!="object"){b.error("JSON is not available, unable to initialize API communications");g();return false}d._xdmAvailable=true;d._init=true;f=(window.location!=window.parent.location)?true:false;h=null;e=document.location.href.match(/xdm_e=([^\&]*)/);if(e!=null&&e.length>=2){h=unescape(e[1])}if(f&&(document.referrer.indexOf(h)!=-1)||document.location.href.match(/(mp_int=1)/)){d._initInternal(g)}else{if(h!=null){j=b.removeURLParam(document.location.href,"xdm_e");j=b.removeURLParam(j,"xdm_c");j=b.removeURLParam(j,"xdm_p");return document.location.href=j}d._initExternal(g)}};this._initInternal=function(f){var h;try{d._rpc=new easyXDM.Rpc({local:d._local,swf:LeChuckAPIjsBasedir+"easyxdm/easyxdm.swf",remoteHelper:b.site+"helpers/game/xdmname.html",onReady:function(){h=setTimeout(function(){if(!d._connected){b.debug("Hello not received from parent (internal) trying external integration...");if(d._rpc){d._rpc.destroy()}d._initExternal(f)}},1000)}},{remote:{login:{},register:{},openBuyItems:{},toComments:{},toSimilarGames:{},toHighscoreGlobal:{},toHighscoreFriends:{},toAchievements:{},toControls:{},highlightLikeGame:{},highlightFavGame:{},highlightAchievements:{},toDescription:{},toSagaGames:{},toCollectionGames:{},toUserShare:{},toUserChallenge:{},maximize:{},minimize:{},debug:{},setSize:{},resetSize:{},setViewportScale:{},showOverlay:{},hideOverlay:{},error:{},onApiAuthenticate:{},get:{}},local:{hello:function(k,j,e){if(!k instanceof Object){if(e instanceof Function){e()
}return}d._connected=true;if(h){clearTimeout(h)}if(!"env_is_internal" in k||k.env_is_internal==false){throw new Error("Integration type mismatch")}b.integration_type="internal";b.is_internal=true;b.is_external=false;b.debug("Hello received from parent (internal), cross domain communications enabled!. Integration type: "+b.integration_type);if("env_locale" in k){b.locale=k.env_locale}if("env_parent" in k){d._remote=k.env_parent}if("env_is_scalable" in k){b._player.is_scalable=k.env_is_scalable}if("env_is_resizable" in k){b._player.is_resizable=k.env_is_resizable}if("env_is_maximized" in k){b._player.is_maximized=k.env_is_maximized}if("env_view_type" in k){b._player.view_type=k.env_view_type}if("env_size" in k){b._player.size=k.env_size}if("env_current_size" in k){b._player.current_size=k.env_current_size}if("user_id" in k){if(b.user_id&&b.user_id!=k.user_id){b.error("User id received from the environment doesn't match the user id provided to the JS API. Disconnecting user from the API.");b.user.die(true)}}f();if(j instanceof Function){j()}},getCallback:function(j,e){if(typeof b._xdmGetCallbacks[j]==="undefined"){return false}if(b._xdmGetCallbacks[j] instanceof Function){b._xdmGetCallbacks[j](e)}b.selfApi._xdmGetCallbacks[j]=false},die:function(e){b.debug("Die message received");b.user.die(true)},resize:function(e){b.debug("Resize message received");if(e instanceof Object){if("env_view_type" in e){b._player.view_type=e.env_view_type}if("env_current_view_type" in e){b._player.current_view_type=e.env_current_view_type}if("env_is_maximized" in e){b._player.is_maximized=e.env_is_maximized}if("env_size" in e){b._player.size=e.env_size}if("env_current_size" in e){b._player.current_size=e.env_current_size}}b.eventHandler.triggerEvent("playerResize");b._callASEvent("resize")},buyItemsCallback:function(e,j){b.items._buyCompleted(e);if(j instanceof Function){j()}},buyItemsBlocked:function(){response=new b.items._buyResponse();response.success=false;response.errorType="POPUP_BLOCKED";
response.errorMessage="The pop-up window was blocked";if(b._buyItemsCallback instanceof Function){b.callCallback(b._buyItemsCallback,response);b._buyItemsCallback=false}},shareCallback:function(j,e){b.environment.onShareCallback(j,e)}}})}catch(g){b.error("Unable to create easyXDM rpc (Internal integration): "+g.message);if(d._rpc){d._rpc.destroy()}clearTimeout(h);f()}};this._initExternal=function(f){try{d._remote=b._getMatchingSite()+"helpers/game/xdmbridge.php?xdm_url="+encodeURI(LeChuckAPIjsBasedir+"easyxdm/");d._rpc=new easyXDM.Rpc({isHost:true,local:d._local,remote:d._remote,remoteHelper:b._getMatchingSite()+"helpers/game/xdmname.html",swf:LeChuckAPIjsBasedir+"easyxdm/easyxdm.swf"},{remote:{openBuyItems:{},openLogin:{},get:{}},local:{hello:function(j,h,e){if(!j instanceof Object){if(e instanceof Function){e()}return}d._connected=true;if("env_is_internal" in j&&j.env_is_internal==true){throw new Error("Integration type mismatch")}b.integration_type="external";b.is_internal=false;b.is_external=true;b.debug("Hello received from child (external), cross domain communications enabled!. New integration type: "+b.integration_type);if(h instanceof Function){h()}f()},getCallback:function(h,e){if(typeof b._xdmGetCallbacks[h]==="undefined"){return false}if(b._xdmGetCallbacks[h] instanceof Function){b._xdmGetCallbacks[h](e)}b.selfApi._xdmGetCallbacks[h]=false},buyItemsCallback:function(e,h){b.items._buyCompleted(e);if(h instanceof Function){h()}},buyItemsBlocked:function(){response=new b.items._buyResponse();response.success=false;response.errorType="POPUP_BLOCKED";response.errorMessage="The pop-up window was blocked";if(b._buyItemsCallback instanceof Function){b.callCallback(b._buyItemsCallback,response);b._buyItemsCallback=false}},loginCallback:function(e,h,j){b.user._loginCallback(e,h);if(j instanceof Function){j()}},loginBlocked:function(){if(b.locale.indexOf("es")!=-1){alert("El pop-up para iniciar sesión ha sido bloqueado por su navegador. Por favor, habilítelo para poder iniciar sesión con MiniPlay Connect.")
}else{alert("Please allow the pop-up in order to login with MiniPlay Connect.")}}}})}catch(g){b.error("Unable to create easyXDM rpc (External integration): "+g.message);if(d._rpc){d._rpc.destroy()}f()}}};this._missingOption=function(e,f,d){if(d==undefined){d=document.location.href}if(this.anonymousMode){this.enableDebug=true;if(e=="id"){b.error("WARNING: '"+e+"' option is mandatory, the API will work but some features will be disabled. You must provide it either directly or through the '"+f+"' url parameter. Possible urls: "+d)}else{b.error("WARNING: '"+e+"' option is mandatory, you must provide it either directly or through the '"+f+"' url parameter. Possible urls: "+d)}}else{throw Error("'"+e+"' option is mandatory, you must provide it either directly or through the '"+f+"' url parameter. Possible urls: "+d)}};this._getMatchingSite=function(){if(b._isHttps()){return b.site_https}else{return b.site}};this._isHttps=function(){return document.location.protocol=="https:"};this._isTrustedDomain=function(f,d){var e,h;if(typeof f!="string"){return false}if(!d instanceof Array){return false}e=f.match(/^(https?\:\/\/([^\/]+))/);h=false;if(e!=null&&e.length>=3){h=e[2]}if(!h){return false}for(var g=0;g<d.length;g++){if(h.match(d[g])!=null){return true}}throw new Error("Domain "+h+" not trusted, the API is going to die...");return false};this.init=function(){var f,e;var d=document.location.href+" "+document.referrer;if(a instanceof Object==false){a={}}if("anonymousMode" in a){this.anonymousMode=!!a.anonymousMode}else{if(LeChuckAPIjsBasedir.match(/mp_anonymous/)||d.match(/mp_anonymous/)){this.anonymousMode=true}}if(this.anonymousMode){b.debug("AnonymousMode enabled.")}if(("unity" in a)&&a.unity){this.is_unity=true}if(!("id" in a)||a.id.length==0){f=d.match(/mp_api_id=([0-9]*)/);if(f!=null&&f.length>=2){this.id=f[1]}}else{this.id=a.id}if(!this.id||this.id.length==0){this._missingOption("id","mp_api_id",d)}if(!("site" in a)||a.site.length==0){f=d.match(/mp_site_url=([a-zA-Z0-9 \.\+\-\_\%]*)/);
if(f!=null&&f.length>=2){e=unescape(f[1]);if(b._isTrustedDomain(e,b._trustedDomainsSite)){this.site=unescape(f[1])}}}else{this.site=a.site}if(!this.site||this.site.length==0){this._missingOption("site","mp_site_url",d)}if(this.site.length>0&&this.site.charAt(this.site.length-1)!="/"){this.site+="/"}if(!("site_https" in a)||a.site_https.length==0){f=d.match(/mp_site_https_url=([a-zA-Z0-9 \.\+\-\_\%]*)/);if(f!=null&&f.length>=2){e=unescape(f[1]);if(b._isTrustedDomain(e,b._trustedDomainsSite)){this.site_https=unescape(f[1])}}}else{this.site_https=a.site_https}if(!this.site_https||this.site_https.length==0){this._missingOption("site","mp_site_https_url",d)}if(this.site_https.length>0&&this.site_https.charAt(this.site_https.length-1)!="/"){this.site_https+="/"}if(!("url" in a)||a.url.length==0){f=d.match(/mp_api_js_url_bck=([a-zA-Z0-9 \.\+\-\_\%]*)/);if(f!=null&&f.length>=2){e=unescape(f[1]);if(b._isTrustedDomain(e,b._trustedDomainsBackend)){this.url=e}}}else{this.url=a.url}if(!this.url||this.url.length==0){this._missingOption("site","mp_api_js_url_bck",d)}if(this.url.charAt(this.url.length-1)!="/"){this.url+="/"}if(!("user_token" in a)||a.user_token.length==0){f=d.match(/mp_api_user_token=([a-z0-9]*)/);if(f!=null&&f.length>=2){this.user_token=unescape(f[1])}}else{this.user_token=a.user_token}if(!("user_id" in a)||a.user_id.length==0){f=d.match(/mp_api_user_id=([a-z0-9]*)/);if(f!=null&&f.length>=2){this.user_id=f[1]}}else{this.user_id=a.user_id}if(!("locale" in a)||a.locale==0){f=d.match(/mp_locale=([a-zA-Z0-9\_]*)/);if(f!=null&&f.length>=2){this.locale=f[1]}}else{this.locale=a.locale}if(!("locale_lang" in a)||a.locale_lang==0){this.locale_lang=this.locale.split("_")[0]}else{this.locale_lang=a.locale_lang}if(!("mobile" in a)){f=d.match(/mp_mobile=1/);if(f!=null&&f.length>=1){this.is_mobile=true}}else{this.is_mobile=a.mobile}if("debug" in a){this.enableDebug=!!a.debug}if(LeChuckAPIjsBasedir.match(/mp_game_devel/)||d.match(/mp_game_devel/)){this.enableDebug=true}if(LeChuckAPIjsBasedir.match(/mp_debug/)||d.match(/mp_debug/)){this.enableDebug=true
}b.debug("Configuring API.");if("flash_object_id" in a&&a.flash_object_id.length>0){this.setFlashObject(a.flash_object_id)}b.integration_type="external";b.is_external=true;b.is_internal=false;if("xdm_local" in a&&a.xdm_local.length>0){this.xdm._local=a.xdm_local}b.xdm.init(b.apiReady);if(!("is_embed" in a)||a.is_embed.length==0){f=d.match(/mp_embed=([0-9]*)/);if(f!=null&&f.length>=2){this.is_embed=unescape(f[1])}}else{this.is_embed=a.is_embed}};this.markApiAsReady=function(){if(!b._ready){b._ready=true;if(window.hasOwnProperty("onLeChuckAPIReady")&&typeof window.onLeChuckAPIReady=="function"){window.onLeChuckAPIReady(window.LeChuckAPI)}b.unity.sendApiReadyMessage();b.eventHandler.triggerEvent("apiReady");b.eventHandler.triggerEvent("playerResize")}};this.apiReady=function(){b.eventHandler.init();b.debug("Initializing API. Integration type: "+b.integration_type);b._ready=false;if(b.id){if(b.user_token&&b.user_id){b.user.secureAuth(function(d){if(d.isValid){b.debug("User connected & authenticated successfully")}else{b.error("Couldn't authenticate user, error: "+d.errorMessage+" user will be disconnected");b.user.die(true)}b.markApiAsReady();if(d.isValid){b.stat.put(function(){},"api-loaded",1)}});return}else{b.user_token=null;b.user_id=null}}else{b.debug("WARNING, no API ID provided. API MODE: ANONYMOUS")}b.markApiAsReady()};this.init();window.LeChuckAPI={events:{onDocumentReady:function(d){b.eventHandler.registerEventListener("documentReady",typeof d!="undefined"?d:function(){})},onApiReady:function(d){(b._ready&&d instanceof Function)?d():b.eventHandler.registerEventListener("apiReady",typeof d!="undefined"?d:function(){})},onUserDisconnect:function(d){b.eventHandler.registerEventListener("userDisconnect",typeof d!="undefined"?d:function(){})},onPlayerResize:function(d){b.eventHandler.registerEventListener("playerResize",typeof d!="undefined"?d:function(){})}},environment:{getLocale:function(){return b.environment.getLocale()},getLocaleLang:function(){return b.environment.getLocaleLang()
},isExternal:function(){return b.environment.isExternal()},isInternal:function(){return b.environment.isInternal()},isMobile:function(){return b.environment.isMobile()},toComments:function(){b.environment.toComments()},toHighscoreGlobal:function(e,d){b.environment.toHighscoreGlobal(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},toHighscoreFriends:function(d){b.environment.toHighscoreFriends(typeof d!="undefined"?d:null)},toAchievements:function(){b.environment.toAchievements()},toControls:function(){b.environment.toControls()},highlightLikeGame:function(){b.environment.highlightLikeGame()},highlightFavGame:function(){b.environment.highlightFavGame()},highlightAchievements:function(){b.environment.highlightAchievements()},toDescription:function(){b.environment.toDescription()},toSimilarGames:function(){b.environment.toSimilarGames()},toSagaGames:function(){b.environment.toSagaGames()},toCollectionGames:function(){b.environment.toCollectionGames()},toShare:function(){b.environment.toUserShare([],{},"",function(d){})},toUserShare:function(f,e,d){if(typeof customMessage!="string"){customMessage=""}if(typeof f=="undefined"||!(f instanceof Array)){f=""}if(typeof e!="object"){e={}}if(typeof d!="function"){d=function(h,g){}}return b.environment.toUserShare(f,e,d)},toUserChallenge:function(h,f,g,e,d){if(typeof customMessage!="string"){customMessage=""}if(typeof h=="undefined"||!(h instanceof Array)){h=""}if(typeof g!="boolean"){g=true}if(typeof f!="boolean"){f=false}if(typeof e!="object"){e={}}if(typeof d!="function"){d=function(k,j){}}return b.environment.toUserChallenge(h,f,g,e,d)},player:{isScalable:function(){return b.environment.player.isScalable()},isResizable:function(){return b.environment.player.isResizable()},isMaximized:function(){return b.environment.player.isMaximized()},maximize:function(){return b.environment.player.maximize()},minimize:function(){return b.environment.player.minimize()},getSize:function(){return b.environment.player.getSize()},getCurrentSize:function(){return b.environment.player.getCurrentSize()
},getViewType:function(){return b.environment.player.getViewType()},getCurrentViewType:function(){return b.environment.player.getCurrentViewType()},setSize:function(e,d){b.environment.player.setSize(e,d)},setViewportScale:function(d){b.environment.player.setViewportScale(d)},showOverlay:function(){b.environment.player.showOverlay()},hideOverlay:function(){b.environment.player.hideOverlay()},resetSize:function(){b.environment.player.resetSize()}}},ads:b.ads,unity:b.unity,item:{list:function(d){return b.items.list(typeof d!="undefined"?d:null)},detail:function(e,d){return b.items.detail(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},eat:function(f,d,e){return b.items.eat(typeof f!="undefined"?f:null,typeof d!="undefined"?d:null,typeof e!="undefined"?parseInt(e,10):1)},inventory:function(e,d){return b.items.inventory(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},stock:function(f,d,e){return b.items.stock(typeof f!="undefined"?f:null,typeof d!="undefined"?d:null,typeof e!="undefined"?e:null)},userLog:function(e,d){return b.items.userLog(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},buy:function(e,d){return b.items.buy(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)}},stat:{get:function(e,d){return b.stat.get(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},put:function(f,e,d){return b.stat.put(typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},batch:function(f,e,d){return b.stat.batch(typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)}},datastore:{status:function(d){return b.datastore.status(typeof d!="undefined"?d:null)},load:function(e,d){return b.datastore.load(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},save:function(g,f,e,d){return b.datastore.save(typeof g!="undefined"?g:null,typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},reset:function(e,d){return b.datastore.reset(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)
}},highscore:{global:function(f,e,d){return b.highscore.global(typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},friends:function(f,e,d){return b.highscore.friends(typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},score:function(f,e,d){return b.highscore.score(typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},position:function(f,e,d){return b.highscore.position(typeof f!="undefined"?f:null,typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)}},user:{isGuest:function(){return b.user.isGuest()},login:function(){return b.user.login()},register:function(){return b.user.register()},die:function(d){return b.user.die(d||false)},authenticate:function(f,d,e){return b.user.secureAuth(typeof f!="undefined"?f:null,typeof d!="undefined"?d:null,typeof e!="undefined"?e:null)},secureAuth:function(f,d,e){return b.user.secureAuth(typeof f!="undefined"?f:null,typeof d!="undefined"?d:null,typeof e!="undefined"?e:null)},get:function(f,d,e){return b.user.get(typeof f!="undefined"?f:null,typeof d!="undefined"?d:null,typeof e!="undefined"?e:null)},followers:function(e,d){return b.user.followers(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},subscriptions:function(e,d){return b.user.subscriptions(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},subscriptionStatus:function(f,d,e){return b.user.subscriptionStatus(typeof f!="undefined"?f:null,typeof d!="undefined"?d:null,typeof e!="undefined"?!!e:false)},friends:function(e,d){return b.user.friends(typeof e!="undefined"?e:null,typeof d!="undefined"?d:null)},getId:function(){return b.user_id},getUid:function(){return b.user_uid},getLevel:function(){return b.user_progress_level},getAvatar:function(){return b.user_avatar},getAvatarMini:function(){return b.user_avatar_mini},getAvatarBig:function(){return b.user_avatar_big},getAvatarAlpha:function(){return b.user_avatar_alpha},getAvatarBody:function(){return b.user_avatar_body
},getProfile:function(){return b.user_profile},getToken:function(){return b.user_token}},logAS:{log:function(d,e){return b.logAS.log(typeof d!="undefined"?d:null,typeof e!="undefined"?e:null)},get:function(d){return b.logAS.get(typeof d!="undefined"?d:null)},print:function(d){return b.logAS.get(typeof d!="undefined"?d:null)}},getId:function(){return b.id},getVersion:function(){return b.getVersion()},getFlashObject:function(){return b.getFlashObject()},setFlashObject:function(d){return b.setFlashObject(typeof d!="undefined"?d:null)},getScript:function(e,f,d){return b.getScript(e,typeof f!="undefined"?f:null,typeof d!="undefined"?d:null)},setPayload:function(d){return b.clientPayload=d},getPayload:function(){return b.clientPayload},setDebug:function(d){return b.enableDebug=(typeof d==undefined?true:!!d)}};c=window.LeChuckAPI;return window.LeChuckAPI}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(j){var m="";var d,b,g,p,c,l,k;var h=0;j=Base64._utf8_encode(j);while(h<j.length){d=j.charCodeAt(h++);b=j.charCodeAt(h++);g=j.charCodeAt(h++);p=d>>2;c=(d&3)<<4|b>>4;l=(b&15)<<2|g>>6;k=g&63;if(isNaN(b)){l=k=64}else{if(isNaN(g)){k=64}}m=m+this._keyStr.charAt(p)+this._keyStr.charAt(c)+this._keyStr.charAt(l)+this._keyStr.charAt(k)}return m},decode:function(j){var m="";var d,b,g;var p,c,l,k;var h=0;j=j.replace(/[^A-Za-z0-9+/=]/g,"");while(h<j.length){p=this._keyStr.indexOf(j.charAt(h++));c=this._keyStr.indexOf(j.charAt(h++));l=this._keyStr.indexOf(j.charAt(h++));k=this._keyStr.indexOf(j.charAt(h++));d=p<<2|c>>4;b=(c&15)<<4|l>>2;g=(l&3)<<6|k;m=m+String.fromCharCode(d);if(l!=64){m=m+String.fromCharCode(b)}if(k!=64){m=m+String.fromCharCode(g)}}m=Base64._utf8_decode(m);return m},_utf8_encode:function(c){c=c.replace(/rn/g,"n");var a="";for(var d=0;d<c.length;d++){var b=c.charCodeAt(d);if(b<128){a+=String.fromCharCode(b)}else{if(b>127&&b<2048){a+=String.fromCharCode(b>>6|192);a+=String.fromCharCode(b&63|128)}else{a+=String.fromCharCode(b>>12|224);
a+=String.fromCharCode(b>>6&63|128);a+=String.fromCharCode(b&63|128)}}}return a},_utf8_decode:function(c){var a="";var d=0;var b=c1=c2=0;while(d<c.length){b=c.charCodeAt(d);if(b<128){a+=String.fromCharCode(b);d++}else{if(b>191&&b<224){c2=c.charCodeAt(d+1);a+=String.fromCharCode((b&31)<<6|c2&63);d+=2}else{c2=c.charCodeAt(d+1);c3=c.charCodeAt(d+2);a+=String.fromCharCode((b&15)<<12|(c2&63)<<6|c3&63);d+=3}}}return a}};function base64_encode(a){return Base64.encode(a)}function base64_decode(a){return Base64.decode(a)};